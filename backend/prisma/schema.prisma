
generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model User {
  id           Int           @id @default(autoincrement())
  name         String
  email        String        @unique
  password     String
  role         ROLE          @default(USER)
  reservations Reservation[]
}

model Movie {
  id          Int        @id @default(autoincrement())
  name        String
  description String?
  posterUrl   String?
  duration    Int?
  releaseDate DateTime?
  showTimes   Showtime[]
}

model theater {
  id        Int        @id @default(autoincrement())
  name      String
  address   String
  city      String
  state     String
  showTimes Showtime[]
}

model Showtime {
  id           Int           @id @default(autoincrement())
  movieId      Int
  movie        Movie         @relation(fields: [movieId], references: [id])
  theaterId    Int
  theater      theater       @relation(fields: [theaterId], references: [id])
  startTime    DateTime
  price        Int
  reservations Reservation[]
}

model Reservation {
  id         Int                @id @default(autoincrement())
  showtime   Showtime           @relation(fields: [showtimeId], references: [id])
  showtimeId Int
  userId     Int
  user       User               @relation(fields: [userId], references: [id])
  status     String             @default("BOOKED")
  seats      ReservationSeats[]
  createdAt  DateTime           @default(now())
}

model ReservationSeats {
  id            Int         @id @default(autoincrement())
  reservationId Int
  reservation   Reservation @relation(fields: [reservationId], references: [id])
  seatNumber    Int
}

enum ROLE {
  USER
  ADMIN
}